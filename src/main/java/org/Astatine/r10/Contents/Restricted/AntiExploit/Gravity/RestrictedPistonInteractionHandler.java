package org.Astatine.r10.Contents.Restricted.AntiExploit.Gravity;

import java.util.List;

import org.Astatine.r10.Contents.EventRegister;
import org.bukkit.block.Block;
import org.bukkit.event.block.BlockPistonExtendEvent;

public class RestrictedPistonInteractionHandler implements EventRegister {
    private List<Block> targetBlockList;
    private final BlockPistonExtendEvent event;

    public RestrictedPistonInteractionHandler(BlockPistonExtendEvent event) {
        this.event = event;
        init();
        execute();
    }

    @Override
    public void init() {
        this.targetBlockList = this.event.getBlocks();
    }

    @Override
    public void execute() {
        boolean isRestrictedBlock = this.targetBlockList.stream()
            .anyMatch(block -> block.getType().hasGravity());

        if (isRestrictedBlock)
            this.event.setCancelled(true);
    }
}
